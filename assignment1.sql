
create table emp(

    EMP_CODE varchar(5) NOT NULL,
    EMP_NAME VARCHAR(20),
    DEPT_CODE VARCHAR(5),
    DESIG_CODE VARCHAR(5),
    SEX VARCHAR(1),
    ADDRESS VARCHAR(25),
    CITY VARCHAR(20),
    STATE VARCHAR(20),
    PIN VARCHAR(6),
    BASIC NUMERIC DEFAULT 0,
    JN_DT DATETIME DEFAULT CURRENT_TIMESTAMP,

PRIMARY KEY(EMP_CODE)

);

SELECT * FROM  EMP;

CREATE TABLE DESIGNATION(
    DESIG_CODE VARCHAR(5),
    DESIG_DESC VARCHAR(20)

    PRIMARY KEY(DESIG_CODE)
);

SELECT * FROM  DESIGNATION;

CREATE TABLE DEPARTMENT(
    DEPT_CODE VARCHAR(5),
    DEPT_NAME VARCHAR(20)

    PRIMARY KEY(DEPT_CODE)
);

SELECT * FROM  DEPARTMENT;



INSERT INTO DEPARTMENT

VALUES
    ('PERS','PERSONNEL'),
    ('PROD','PRODUCTION'),
    ('PURC','PURCHASE'),
    ('FINC','FINANCE'),
    ('RESC','RESEARCH');

INSERT INTO DESIGNATION VALUES ('MGR','MANAGER'),('EXEC','EXECUTION'),('OFR','OFFICER'),('CLK','CLERK'),('HLPR','HELPER');

INSERT INTO EMP(
    EMP.EMP_CODE,
    EMP.EMP_NAME,
    EMP.DEPT_CODE,
    EMP.DESIG_CODE,
    EMP.SEX,
    EMP.ADDRESS,
    EMP.CITY,
    EMP.[STATE],
    EMP.PIN,
    EMP.BASIC
)

VALUES

('001','ADAM','PROD','EXEC','M','21L GREEN STREET','KOLKATA','WB','81',1000000),
('002','MORITZ','PERS','MGR','M','27P MART STREET','KOLKATA','WB','97',1900000),
('003','MINCY','PROD','EXEC','F','L7 GREL STREET','HARIDWAR','UP','80',1800000),
('004','DANIEL','PERS','EXEC','M','2L GREY STREET','KOLKATA','WB','81',1060000),
('005','CALI','PURC','OFR','M','2A RED STREET','KOLKATA','WB','81',1500000),
('006','NEIL','FINC','CLK','M','WL8 PURP STREET','KOLKATA','WB','81',1001000),
('007','LANA','RESC','HLPR','F','21L GRAY STREET','KOLKATA','WB','81',1200000);

INSERT INTO EMP(
    EMP.EMP_CODE,
    EMP.EMP_NAME,
    EMP.DEPT_CODE,
    EMP.DESIG_CODE,
    EMP.SEX,
    EMP.ADDRESS,
    EMP.CITY,
    EMP.[STATE],
    EMP.PIN,
    EMP.BASIC
)

VALUES

('011','HARRY',NULL,'EXEC','M','21L RANT STREET','KOLKATA','WB','81',0),
('008','AMANDA',NULL,'EXEC','F','21L GREEN STREET','KOLKATA','WB','81',NULL),
('009','MICHELE',NULL,'MGR','F','27P MART STREET','KOLKATA','WB','97',NULL),
('010','NATE',NULL,'EXEC','M','L7 GREL STREET','HARIDWAR','UP','80',NULL);

SELECT * FROM EMP WHERE DEPT_CODE IS NULL;

SELECT * FROM EMP WHERE BASIC=0;

SELECT * FROM EMP WHERE BASIC IS NULL;

SELECT AVG(BASIC) FROM EMP;/*  AFTER -> 860090.909090 */

UPDATE EMP SET BASIC=0 WHERE BASIC IS NULL;

DELETE FROM EMP WHERE DEPT_CODE IS NULL;

SELECT EMP_NAME,1.9*BASIC AS NETPAY  FROM EMP; 

SELECT UPPER(EMP_NAME) ,BASIC FROM EMP ORDER BY DEPT_CODE;

SELECT * FROM EMP WHERE JN_DT >1990-01-01;

SELECT * FROM EMP WHERE MONTH(EMP.JN_DT)='2';

SELECT MAX(BASIC) AS MAX_BASIC,MIN(BASIC) AS MIN_BASIC FROM EMP;

SELECT * FROM EMP WHERE SEX='F';

/*UPDATE EMP SET CITY=REPLACE(CITY,CITY,LOWER(CITY));*/

UPDATE EMP SET CITY=REPLACE(CITY,CITY,UPPER(CITY));

SELECT DISTINCT CITY FROM EMP;

SELECT * FROM EMP ORDER BY DEPT_CODE,BASIC DESC;

SELECT * FROM EMP ORDER BY DEPT_CODE IN(SELECT * FROM EMP ORDER BY BASIC DESC);